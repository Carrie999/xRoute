{"version":3,"sources":["webpack:///./src/lib/js/index.js?e42f","webpack:///./src/lib/js/controller.js?a91c","webpack:///./src/lib/js/model.js?74c2","webpack:///./~/.1.0.0@whatwg-fetch/fetch.js?2bf3","webpack:///./src/lib/js/eventEmitter.js?75b1","webpack:///./src/lib/js/xRoute.js?3a53"],"names":["Controller","totalModel","route","name","containerName","model","containerBox","domMap","domMapCache","eventCache","viewInit","viewDestory","inited","document","querySelector","setDomMap","bindEvents","pageInit","obj","key","item","addEventListener","actionName","action","bind","fn","Model","Object","create","records","created","extend","extended","call","include","included","prototype","init","object","parent","instance","apply","arguments","post","url","Promise","resolve","reject","fetch","method","headers","body","JSON","stringify","then","data","json","get","getHash","window","location","hash","slice","newRecord","dup","destory","update","assign","save","find","console","log","setLocItem","value","itemValue","type","toString","undefined","localStorage","setItem","getLocItem","getItem","removeLocItem","removeItem","controllers","registerController","EventEmitter","cache","context","push","shift","fns","length","i","_fn","_f","splice","Router","useHash","pageCache","history","pushState","e","state","path","handleRoute","addRoute","cb","config","view","split","join","routeObj","isFromHistory","curContext","oldPath","forEach","index","routeItem","routeClassHandle","href","target","dataset","oldHash","preventDefault","classList","remove","add","bootstrap","router","currHash","flag","lastArr","go","back"],"mappings":"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CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA,wDAAuD;AACvD,UAAS;AACT;AACA,UAAS;AACT,+EAA8E;AAC9E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA,wCAAuC,0BAA0B;AACjE;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,gCAA+B,0BAA0B,eAAe;AACxE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAA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","file":"js/register/lib.js","sourcesContent":["import {Controller} from 'jsLib/controller';\nimport {totalModel} from 'jsLib/model';\nimport {route} from 'jsLib/xRoute';\n\n\nexport {\n    Controller,\n    totalModel,\n    route\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/js/index.js\n **/","export class Controller {\n    constructor(name, containerName, model) {\n        this.name = name;\n        this.containerName = containerName || '';\n        this.containerBox = null;\n        this.domMap = {};\n        this.domMapCache = {};\n        this.eventCache = {};\n        this.model = model || {};\n        this.viewInit = null || function() {};\n        this.viewDestory = null || function() {};\n        \n        this.inited = false;\n    }\n    //init函数\n    init() {\n        //console.log(this);\n        this.containerBox = document.querySelector(this.containerName);\n        this.setDomMap();\n        this.bindEvents();\n        this.model.pageInit();\n        this.viewInit();\n\n        this.inited = true;\n        \n        return this;\n    }\n    setModelCache(obj = {}) {\n        this.model = obj;\n        return this;\n    }\n    getDomMap(obj = {}) {\n        this.domMapCache = obj;\n        return this;\n    }\n    //dom缓存\n    setDomMap() {\n        let obj = this.domMapCache;\n        for(let key in obj) {\n            this.domMap[key] = this.containerBox.querySelector(obj[key]);\n        }\n        return this;\n    }\n    getBindEvents(obj = {}) {\n        this.eventCache = obj;\n        return this;\n    }\n    //事件绑定\n    bindEvents() {\n        let obj = this.eventCache;\n        for(let key in obj) {\n            let item = obj[key];\n            this.domMap[key].addEventListener(item.actionName, item.action.bind(this.domMap[key]));\n        }\n        return this;\n    }\n    \n    unbindEvent() {\n        \n    }\n    \n    //钩子: 页面初始化(willAppear阶段)\n    getViewInit(fn) {\n        this.viewInit = fn.bind(this) || function() {};\n        return this;\n    }\n\n    //钩子: 页面销毁阶段(willDisappear阶段)\n    getViewDestory(fn) {\n        this.viewDestory = fn.bind(this) || function() {};\n        return this;\n    }\n\n    //获取controller的初始化状态\n    get getInitedStatus() {\n        return this.inited;\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/js/controller.js\n **/","import 'whatwg-fetch';\nimport {Controller} from './controller';\nimport EventEmitter from './eventEmitter';\n\nlet Model = Object.create(EventEmitter);\n\n//Model用以创建新模型,新模型用以创建实例\nModel = {\n    records: {},\n    //model创建后的回调\n    created() {\n        this.records = {};  //创建新的model后,清空records,避免records被其他的model共享而发生副作用\n    },\n    extend(obj = {}) {\n        let extended = obj.extended;\n        for (let key in obj) {\n            this[key] = obj[key];\n        }\n        if (extended) extended.call(this);\n    },\n    include(obj = {}) {\n        let included = obj.included;\n        for (let key in obj) {\n            this.prototype[key] = obj[key];\n        }\n        if (included) included.call(this);\n    },\n    prototype: {\n        init() {\n\n        }\n    },\n    create() {\n        let object = Object.create(this);   //新模型继承至Model,调用init方法产生新实例\n        object.parent = this;               //新模型.parent = Model\n\n        object.prototype = object.fn = Object.create(this.prototype);\n\n        object.created();\n\n        return object;\n    },\n    init() {\n        let instance = Object.create(this.prototype);\n        instance.parent = this;             //实例.parent = 新模型\n        instance.init.apply(instance, arguments);   //Model.prototype.init();\n        return instance;\n    }\n}\n\n\n//ajax  实例继承\nModel.include({\n    post(url = '', obj = {}) {\n        return new Promise((resolve, reject) => {\n            fetch(url, {\n                method: 'POST',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(obj)\n            }).then((data) => {\n                //添加正确处理和错误处理的函数 reject\n                resolve(data.json());\n            })\n        })\n    },\n    get(url = '') {\n        return new Promise((resolve, reject) => {\n            fetch(url)\n                .then((data) => {\n                    //正确处理的方式\n                    resolve(data.json());\n                })\n        })\n    }\n});\n\n//hash值\nModel.include({\n    getHash() {\n        return window.location.hash.slice(2);\n    }\n});\n\n//页面初始化model数据\nModel.include({\n    pageInit() {\n\n    }\n});\n\n//Model对象记录\nModel.include({\n    newRecord: true,\n    create() {\n        this.newRecord = false;\n        //新模型.records[this.name] = this;\n        this.parent.records[this.name] = this.dup();\n    },\n    destory() {\n        delete this.parent.records[this.name];\n    },\n    update() {\n        this.parent.records[this.name] = this.dup();\n    },\n    dup() {\n        return Object.assign({}, this);\n    },\n    save() {\n        this.newRecord ? this.create() : this.update();\n    }\n});\n\nModel.extend({\n    find(name = '') {\n        return this.records[name] || console.log('Unkonwn record');\n    }\n});\n\n\n//localstorage操作\nModel.include({\n    setLocItem(key = '', value) {\n        let itemValue,\n            type = typeof value;\n        if (type === 'string' || type === 'number') {\n            itemValue = value;\n        } else if (Object.prototype.toString.call(value) === '[object Object]') {\n            itemValue = JSON.stringify(value);\n        } else {\n            itemValue = undefined;\n        }\n        localStorage.setItem(key, itemValue);\n    },\n    getLocItem(key = '') {\n        return localStorage.getItem(key);\n    },\n    removeLocItem(key = '') {\n        return localStorage.removeItem(key);\n    }\n});\n\n\n\n\n//controller在Model上进行注册\nModel.include({\n    controllers: {},\n    //这里的controller不能使用容器的选择器确定\n    registerController(name, containerName) {\n        return this.controllers[name] || (this.controllers[name] = new Controller(name, containerName,this));\n    }\n})\n\n\nlet totalModel = Model.create();\n\n\nexport {totalModel}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/js/model.js\n **/","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var list = this.map[name]\n    if (!list) {\n      list = []\n      this.map[name] = list\n    }\n    list.push(value)\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    var values = this.map[normalizeName(name)]\n    return values ? values[0] : null\n  }\n\n  Headers.prototype.getAll = function(name) {\n    return this.map[normalizeName(name)] || []\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = [normalizeValue(value)]\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    Object.getOwnPropertyNames(this.map).forEach(function(name) {\n      this.map[name].forEach(function(value) {\n        callback.call(thisArg, value, name, this)\n      }, this)\n    }, this)\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    reader.readAsArrayBuffer(blob)\n    return fileReaderReady(reader)\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    reader.readAsText(blob)\n    return fileReaderReady(reader)\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (!body) {\n        this._bodyText = ''\n      } else if (support.arrayBuffer && ArrayBuffer.prototype.isPrototypeOf(body)) {\n        // Only support ArrayBuffers for POST method.\n        // Receiving ArrayBuffers happens via Blobs, instead.\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        return this.blob().then(readBlobAsArrayBuffer)\n      }\n\n      this.text = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return readBlobAsText(this._bodyBlob)\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as text')\n        } else {\n          return Promise.resolve(this._bodyText)\n        }\n      }\n    } else {\n      this.text = function() {\n        var rejected = consumed(this)\n        return rejected ? rejected : Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n    if (Request.prototype.isPrototypeOf(input)) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = input\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this)\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function headers(xhr) {\n    var head = new Headers()\n    var pairs = (xhr.getAllResponseHeaders() || '').trim().split('\\n')\n    pairs.forEach(function(header) {\n      var split = header.trim().split(':')\n      var key = split.shift().trim()\n      var value = split.join(':').trim()\n      head.append(key, value)\n    })\n    return head\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = options.status\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = options.statusText\n    this.headers = options.headers instanceof Headers ? options.headers : new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request\n      if (Request.prototype.isPrototypeOf(input) && !init) {\n        request = input\n      } else {\n        request = new Request(input, init)\n      }\n\n      var xhr = new XMLHttpRequest()\n\n      function responseURL() {\n        if ('responseURL' in xhr) {\n          return xhr.responseURL\n        }\n\n        // Avoid security warnings on getResponseHeader when not allowed by CORS\n        if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {\n          return xhr.getResponseHeader('X-Request-URL')\n        }\n\n        return\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: headers(xhr),\n          url: responseURL()\n        }\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/.1.0.0@whatwg-fetch/fetch.js\n ** module id = 12\n ** module chunks = 1 5\n **/","export default class EventEmitter {\n    constructor() {\n        this.cache = [];\n    }\n\n    listen(type, fn, context = this) {\n        !this.cache[type] && (this.cache[type] = []);\n        this.cache[type].push(fn);\n    }\n\n    trigger() {\n        let type = [].shift.call(arguments),\n            fns = this.cache[type];\n\n        if(!fns || fns.length === 0) return false;\n\n        for(let i = 0, fn; fn = fns[i++];) {\n            fn[i].apply(this, [].slice.call(arguments, 1));\n        }    \n        \n    }\n\n    //fn参数不传时,默认清除所有绑定事件\n    remove(type, fn) {\n        let fns = this.cache[type];\n\n        if(!fns) return false;\n\n        if(!fn) {\n            fns && (fns.length = 0);\n        } else {\n            for(let i = 0, _fn; _f = fns[i++];) {\n                if(_fn === fn) {\n                    fns.splice(i, 1);\n                }\n            }\n        }\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/js/eventEmitter.js\n **/","import {dd} from 'jsLib/util';\n\nvar Router = [],\n    useHash = false,\n    pageCache = {}; //在内存中进行缓存\n\n//一开始的判断是否支持H5 API\nif (!history.pushState) useHash = true;\n\n//不管是否支持H5 API, 统一的路由格式为:\n//  #/a/b/c\n\n//如果支持H5 API\nif (!useHash) {\n    window.addEventListener('popstate', (e) => {\n        let state = e.state;\n        //路由的处理\n        if (state && state.path) {\n            handleRoute(state.path, true);\n        } \n        //TODO 对于state为空的情况的处理\n        /*else {\n            dd.dialog.alert('ok');\n        }*/\n    });\n} else {\n    //hash发生变化时监听的方式,因为hashchange事件浏览器的支持度已经比较高了,所以使用hashchange\n\n    //低级浏览器使用 轮询\n    /*\n    let oldHash = location.hash;\n    setInterval(() => {\n        \n        if(oldHash != location.hash) {\n            //TODO do something\n            \n            //存储新的hash值\n            oldHash = location.hash;\n        } \n    }, 100);*/\n\n    //hashchange方式\n    window.addEventListener('hashchange', (e) => {\n        handleRoute(location.hash.slice(2));\n    });\n}\n\n\n//添加路由\nconst addRoute = (path = '', cb = () => { }, config = {}, viewDestory = () => { }, view, context) => {\n    path = path.split('.').join('/');   //转化嵌套的路由   'ccc.aaa'  --->>>   'ccc/aaa'\n\n    let routeObj = {\n        path,           //路由\n        cb,             //页面加载回调\n        config,\n        context,\n        viewDestory,    //页面销毁回调\n        view            //页面视图\n    }\n\n    Router.push(routeObj);\n}\n\n//路由拦截处理.拦截后返回true, 拦截不成功返回false\nconst handleRoute = (path, isFromHistory) => {\n\n    let curContext,\n        oldPath = location.hash.slice(2);\n\n    //页面销毁\n    Router.forEach(function (route, index) {\n        if (route.path === oldPath) {\n            route.viewDestory && route.viewDestory();\n        }\n    })\n\n    for (let i = 0; i < Router.length; i++) {\n        let routeItem = Router[i];\n        if (routeItem.path === path) {\n            //如果是嵌套内的路由被匹配,那么还应该还调用外层的路由回调\n            curContext = routeItem.context ? routeItem.context : window;\n\n            routeItem.cb.apply(curContext, [path]);\n\n            if (!useHash) {\n                //如果是从popstate中获取的状态,那么不应该将其加入历史状态栈中\n                if (!isFromHistory) {\n                    history.pushState({ path: path }, null, '#/' + path);\n                }\n            } else {\n                location.hash = '/' + path;\n            }\n\n            //激活状路由样式处理\n            routeClassHandle(path);\n\n            return true;\n        }\n    }\n    return false;\n}\n\n//TODO 事件冒泡路由拦截  <a href=\"a.html\">   <a href=\"#/a\">  这2种写法处理起来有什么区别?\n//路由的写法统一为:   <a data-href=\"aaa\"></a>\ndocument.addEventListener('click', (e) => {\n    let href = e.target.dataset.href || '',\n        oldHash = location.hash.slice(2);\n\n    //将data-href数据形式转化为路由形式\n    href = href.split('-').join('/');       //将data-href='ccc-aaa' --->>> 转化为 ccc/aaa  外部写法可能存在出入,但是在内部统一转化为a/b/c/d的形式\n\n    if (href) {\n        //添加钩子 路由进行跳转时模型model上数据的处理\n        if (href === oldHash) return;\n\n        if (handleRoute(href)) {\n            //阻止默认事件\n            e.preventDefault();\n\n        }\n    }\n});\n\n//路由激活状态class控制\nconst routeClassHandle = (hash) => {\n    hash = hash.split('/').join('-');\n    if (hash) {\n        document.querySelector('.route-active') && document.querySelector('.route-active').classList.remove('route-active');\n        document.querySelector(`[data-href=${hash}]`) && document.querySelector(`[data-href=${hash}]`).classList.add('route-active');\n    }\n}\n\n\nconst bootstrap = () => {\n    document.addEventListener('DOMContentLoaded', (e) => {\n        let router = Router[0],\n            currHash = location.hash.slice(2),\n            flag = false;\n\n        let lastArr = currHash.split('/')[0];\n\n\n        //TODO 代码比较龊,可以优化的地方还很多\n        Router.forEach(function (item, index) {\n            if (item.path === lastArr) {\n                flag = true;\n                return item.cb.call(item.context || window);\n            }\n        });\n\n        if (lastArr !== currHash) {\n            Router.forEach(function (item, index) {\n                if (item.path === currHash) {\n                    return item.cb.call(item.context || window);\n                }\n            });\n        }\n\n        //初始化active.route样式处理\n        routeClassHandle(currHash);\n\n        if(!flag) {\n            router.cb.call(router.context || window);\n\n            if(!useHash) {\n                history.pushState({ path: router.path }, null, '#/' + router.path);\n            } else {\n                location.hash = '/' + router.path;\n            }\n        }\n\n        //!flag ? router.cb.call(router.context || window) : '';\n    })\n}\n\n\nconst go = function (path) {\n    path = path.split('.').join('/');\n    handleRoute(path);\n}\n\n\nconst back = function (path) {\n\n}\n\n\n\n//TODO 路由的销毁(根据时间来判断)\nvar route = {\n    addRoute,\n    handleRoute,\n    bootstrap,\n    go\n}\n\nexport {route};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/js/xRoute.js\n **/"],"sourceRoot":""}